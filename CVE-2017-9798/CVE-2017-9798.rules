alert http $HOME_NET any -> any any (msg: "ATTACK [PTsecurity] Apache2 <2.2.34 <2.4.27 Optionsbleed (CVE-2017-9798) Leak"; flow: established, from_server; content: "Allow:"; nocase; http_header; pcre: "/Allow:(?: ,|[^\r\n]*(?:[^A-Za-z0-9,\s-_]|,,))/Hi"; threshold: type limit, track by_src, count 1, seconds 10; reference: cve, 2017-9798; reference: url, blog.fuzzing-project.org/60-Optionsbleed-HTTP-OPTIONS-method-can-leak-Apaches-server-memory.html; classtype: attempted-recon; reference: url, github.com/ptresearch/AttackDetection; sid: 10001947; rev: 3; )

alert http any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] Apache2 <2.2.34 <2.4.27 Optionsbleed (CVE-2017-9798) Attempt"; flow: established, to_server; content: "OPTIONS"; http_method; threshold: type both, track by_src, count 20, seconds 30; reference: cve, 2017-9798; reference: url, blog.fuzzing-project.org/60-Optionsbleed-HTTP-OPTIONS-method-can-leak-Apaches-server-memory.html; classtype: attempted-recon; reference: url, github.com/ptresearch/AttackDetection; sid: 10001948; rev: 1; )

